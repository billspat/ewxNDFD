# Welcome to ewxNDFD

ewxNDFD is a Python package to collect and transform weather forecast data from
the National Digital Forecast Database (NDFD) gridded weather forecast.  It was 
created specifically for used by [MSU Enviroweather](https://enviroweather.msu.edu)

This project is currently in early stages and under heavy development.  The goal
is to create a small library for pulling specific daily forecast weather metrics 
for the NWS seven-day forecast for specific locations to augment weather network
data.  This forecast data will be used in crop, pest, and weather models created
by MSU Enviroweather system. 

MSU Enviroweather previously collected forecast data from NDFD by grid, downloading
GRIB files and extracting values. This is the successor to that system with 
the goal of pulling data as needed from the excellent NWS / NDFD REST API system.

Thank you and acknowlegement to the array of offices, programs, and staff within
the US NOAA who develop, caclulate, and distribute these forecasts.  We thank 
the regional US weather offices that review and adjust the forecasts and make 
them freely available soprograms like Enviroweather can provide guidance for our
agricultural community.

## Get started with the package

This program is not yet available on PyPI or conda.  To use, either 
1) obtain a copy of latest build in compressed or wheel form, labelled as ewxndfd-0.0.1.tar.gz or ewxndfd-0.0.1-py3-none-any.whl
   and install using pip, for example:
   
   `pip install ewxndfd-0.0.1-py3-none-any.whl`
2) clone this repository and build the package locally (see Development and building below)
and install the built package file in the 'dist' folder using pip as above.

## Development and building

This POC uses the "hatch" python project management tool which in turn uses uv

- install hatch (see website)
- clone this package 
- cd to ewxndfd directory
- to use in other code, build using `hatch build` which will create a wheel file in the dist/ directory
- to contribute/edit code, try running `hatch run test:pytest` which should create  
  a virtual environment named 'test' and run pytest in that environment.
- tests require access to sample data, which are not included in this repository. 
  The location of there example files is currently hardcoded in the text code, along with the expected dates to check
  based on the files present.   
  Current setup: Copy NDFD CSV files (in ndfd_auto format) matching *_20251119*.csv 
  (for example `maxr_20251119t00.csv` ) into a directory /tests/ndfd_sample_files 

## Example usage

iPython notebooks in the /notebooks folder provide example usage of the package.
These notebooks require the ewxndfd package to be installed in the python environment
used to run the notebooks.

### Enviroweather Only Usage: 

For working with data files generated by the NDFD_Auto seriesof scripts, 
use the following example code.  You must have access to a folder with
the current Enviroweather-formatted NDFD forecast files, and provide the path to that
folder in the code below.

```python
path_to_ndfd = "/data/some/place/ndfd"
from ewxndfd import NDFD, DAILY_NDFD_VARIABLE_TYPES 

# example, show all the variable names available
print(DAILY_NDFD_VARIABLE_TYPES)

# pull out  7 day forecasted minimum temperature for all possible 
# enviroweather stations 
ndfd = NDFD(path_to_ndfd, variable_type="mint")
ndfd_data = ndfd.get_forecast()

#print first 10 rows
print(ndfd_data[0:10])

# convert to long format as a first step in importing into a database
# this is a work in progress and API/syntax will change! 
mint_fcst = n._wide_to_long(ndfd_data)
print(mint_fcst[0:10])

``` 

## Copyright

- Copyright Â© 2025 MSU Trustees
- Free software distributed under the [MIT License](./LICENSE).
